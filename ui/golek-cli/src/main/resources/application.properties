quarkus.banner.enabled=false
# Clean CLI output
quarkus.log.console.enabled=true
quarkus.log.console.level=WARN
quarkus.log.console.format=%s%e%n
quarkus.log.category."io.micrometer.core.instrument".level=ERROR
quarkus.log.category."tech.kayys.golek.engine.plugin.GolekPluginRegistry".level=ERROR

# Redirect logs to a file in the background (opt-in)
quarkus.log.file.enabled=${GOLEK_CLI_FILE_LOG:false}
quarkus.log.file.path=${GOLEK_CLI_LOG_FILE:${user.home}/.golek/logs/cli.log}
quarkus.log.file.level=DEBUG
quarkus.log.file.format=%d{yyyy-MM-dd HH:mm:ss} %-5p [%c{2.}] %s%e%n

quarkus.log.level=WARN
quarkus.log.category."tech.kayys.golek".level=WARN
quarkus.log.category."tech.kayys.golek.engine.inference.InferenceService".level=OFF
quarkus.log.category."tech.kayys.golek.engine.routing.ModelRouterService".level=ERROR
quarkus.log.category."tech.kayys.golek.inference.libtorch.LibTorchProvider".level=ERROR
quarkus.log.category."tech.kayys.golek.inference.djl.DjlProvider".level=ERROR

# Disable all Dev Services during tests
quarkus.devservices.enabled=false
quarkus.keycloak.devservices.enabled=false
quarkus.oidc.enabled=false
quarkus.keycloak.admin-client.devservices.enabled=false

# Dummy storage configuration for tests
inference.model-storage.gcs.project-id=dummy
inference.model-storage.s3.secret-access-key=dummy
inference.model-storage.azure.connection-string=dummy
inference.model-storage.s3.access-key-id=dummy
inference.model-storage.s3.endpoint=dummy

# Package as Uber-JAR for standalone execution
quarkus.package.type=uber-jar

# Enable GGUF provider for local execution
gguf.provider.enabled=true
gguf.provider.model.base-path=${user.home}/.golek/models/gguf
gguf.provider.native.library-dir=${GOLEK_LLAMA_LIB_DIR:}
gguf.provider.native.library-path=${GOLEK_LLAMA_LIB_PATH:}
gguf.provider.gpu.enabled=${GGUF_GPU_ENABLED:true}
gguf.provider.gpu.layers=${GGUF_GPU_LAYERS:8}
gguf.provider.max-context-tokens=${GGUF_MAX_CONTEXT_TOKENS:2048}
gguf.provider.batch-size=${GGUF_BATCH_SIZE:64}
gguf.provider.threads=${GGUF_THREADS:8}

# Enable LibTorch provider for local execution
libtorch.provider.enabled=${GOLEK_EXPERIMENTAL_LIBTORCH:false}
libtorch.provider.model.base-path=${user.home}/.golek/models/torchscript
libtorch.provider.model.extensions=.pt,.pts,.jit,.ts
libtorch.provider.native-lib.library-path=${LIBTORCH_PATH:}

# Enable DJL provider for Java-only local execution
djl.provider.enabled=true
djl.provider.engine=PyTorch
djl.provider.model.base-path=${user.home}/.golek/models/djl
djl.provider.model.extensions=.pt,.pts,.jit,.ts
djl.provider.timeout-seconds=120

# Use local Caffeine cache instead of Redis for CLI
quarkus.cache.type=caffeine

# Dummy Redis host to satisfy dependency injection (commented out to avoid connection attempts)
# quarkus.redis.hosts=redis://localhost:6379

# Dummy provider keys to satisfy configuration validation in tests
golek.provider.cerebras.api-key=dummy
golek.provider.gemini.api-key=dummy
golek.provider.openai.api-key=dummy
golek.provider.anthropic.api-key=dummy

# REST Client URLs for providers
quarkus.rest-client.cerebras-api.url=https://api.cerebras.ai
quarkus.rest-client.ollama-api.url=http://localhost:11434
quarkus.rest-client.gemini-api.url=https://generativelanguage.googleapis.com


# Enable native access for Panama FFM
quarkus.native.additional-build-args=\
--enable-native-access=ALL-UNNAMED,\
-H:+ReportExceptionStackTraces,\
-H:+AddAllCharsets

# If your native lib is packaged inside the app
quarkus.native.resources.includes=**/*.so,**/*.dll,**/*.dylib,native-libs/**

# Faster startup, smaller image
# UPX compression disabled - not supported on macOS
quarkus.native.compression.disable=true
quarkus.native.strip-debug-symbols=true

# If using Reactor / Mutiny workers
quarkus.thread-pool.max-threads=32


# Disable HTTP server binding for CLI to prevent port conflicts
quarkus.http.host-enabled=false

# Disable Observability exporters to prevent 30s shutdown delay
# Keep extensions enabled to satisfy CDI injections
quarkus.otel.metrics.exporter=none
quarkus.otel.logs.exporter=none
quarkus.otel.traces.exporter=none
quarkus.micrometer.export.prometheus.enabled=false

# Snappy shutdown
quarkus.shutdown.timeout=1s
